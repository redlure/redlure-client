<workspace-navbar></workspace-navbar>
<app-alert></app-alert>
<body style="margin: 20px">
  <!--Header row-->
  <div class="row" style="margin-top: 20px;">
    <div class="col-md d-flex justify-content-start">
      <h3 style="display:inline-block">
        <b class="h3-prefix">RES</b>
        <b class="h3-suffix">ULTS</b>
        <img *ngIf="loading" class="float-right" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==" />
      </h3>
    </div>
    <div class="col-md d-flex justify-content-end">
      <button [disabled]="loading" (click)="getResults()" class="btn btn-outline-primary login_btn"><i class="fas fa-sync-alt"></i></button>
      <button (click)="openVisuals()" class="btn btn-outline-dark login_btn" style="margin-left: 2px"><i class="fas fa-chart-pie"></i></button>
    </div>
  </div>
  <!-- End Header-->
  <br>

  <div class="container">
    <!--Stats Row-->
    <div class="row">
      <div *ngIf="scheduled > 0" class="col result-btn btn-outline-info" (click)="openTable('Scheduled')" style="cursor: pointer;">
        <div class="centerBlock">
          <p class="results">{{ scheduled }}</p>
          <hr class="border-info">
          Scheduled
        </div>
      </div>
      <div class="col result-btn btn-outline-primary" (click)="openTable('Sent')" style="cursor: pointer;">
        <div class="centerBlock">
          <p class="results">{{ sent }}</p>
          <hr class="border-primary">
          Sent
        </div>
      </div>
      <div class="col result-btn btn-outline-success border-left border-dark" (click)="openTable('Unopened')" style="cursor: pointer;">
        <div class="centerBlock">
          <p class="results">{{ unopened }}</p>
          <hr class="border-success">
          Unopened
        </div>
      </div>
      <div class="col result-btn btn-outline-secondary" (click)="openTable('Opened')" style="cursor: pointer;">
        <div class="centerBlock">
          <p class="results">{{ opened }}</p>
          <hr class="border-secondary">
          Opened
        </div>
      </div>
      <div class="col result-btn btn-outline-warning" (click)="openTable('Clicked')" style="cursor: pointer;">
        <div class="centerBlock">
          <p class="results">{{ clicked }}</p>
          <hr class="border-warning">
          Clicked
        </div>
      </div>
      <div class="col result-btn btn-outline-danger" (click)="openTable('Submitted')" style="cursor: pointer;">
        <div class="centerBlock">
        <p class="results">{{ submitted }}</p>
        <hr class="border-danger">
        Submitted
        </div>
      </div>
    </div>
    <!-- End Stats Row-->
  </div>

  <br>
  <hr class="border-dark">

  <div class="container-fluid">
    <!--Tables Row-->
    <div class="row">
      
      <div class="col-8 border-right border-dark" style="text-align: center">
        <div class="row h5 text-dark justify-content-md-center">
          Campaigns
        </div>
        <div *ngIf="campaigns.length; else emptyBlock" class="table-responsive" style="overflow-x: auto;">
          <table class="table table-hover table-sm">
            <thead class="thead-light">
              <tr>
                <th scope="col">
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" id="cbHead" class="custom-control-input" (change)="toggleSelectAll($event)" [checked]="selectAll">                            <label class="custom-control-label" for="cbHead"></label>
                  </div>
                </th>
                <th scope="col" *ngFor="let head of campaignHeaders; let i = index">{{ head }}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let campaign of campaigns; let i = index">
                <td>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" id="cb{{ i }}" class="custom-control-input" [(ngModel)]="campaign.state" (change)="toggleSelect($event, campaign.id)">
                    <label class="custom-control-label" for="cb{{ i }}"></label>
                  </div>
                </td>
                <td>{{ campaign.id }}</td>
                <td>{{ campaign.name }}</td>
                <td>{{ campaign.status }}</td>
                <td>{{ campaign.server.alias }}</td>
                <td>{{ campaign.start_time }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <ng-template #emptyBlock>
          <br>
          <p style="font-style: italic;">No campaigns created yet</p>
        </ng-template>

      </div>

      <div class="col" style="text-align: center">
        <div class="row h5 text-dark justify-content-md-center">
          Credential Vault
        </div>
          <div *ngIf="forms.length; else emptyFormBlock" class="table-responsive">
            <div style="overflow: auto">
              <table class="table table-hover table-sm">
                <thead class="thead-light">
                  <tr>
                    <th scope="col" *ngFor="let head of credHeaders; let i = index">{{ head }}</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="cursor: pointer;" *ngFor="let form of forms" (click)="openFormModal(form)">
                    <td>{{ getEmail(form.result_id) }}</td>
                    <td>{{ getCId(form.result_id) }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <ng-template #emptyFormBlock>
            <br>
            <p style="font-style: italic">No forms submitted yet</p>
          </ng-template>

      </div>
    </div>

  </div>
</body>